/*! Premise-WP 2016-08-29 */
(function(a){a.fn.premiseDynamicColumns=function(b){if(this.length===0){return this}var c=a.extend({},a.fn.premiseDynamicColumns.defaults,b);var d=this;if(this.length>1){this.each(function(){a(this).premiseDynamicColumns(b)});return this}var e=function(){if(!d.is(".premise-dynamic-row"))d.addClass("premise-dynamic-row");"row"==c.grid?d.addClass("premise-row"):d.addClass("premise-inline");var a=[2,3,4,5,6],b=d.children(),e=0,f=6;if(b.length){e=b.length;for(var g=a.length-1;g>=0;g--){if(e%a[g]===0){f=a[g];b.addClass("premise-dyn-col col"+f);return}}b.addClass("premise-dyn-col col"+f)}return};e();return this};a.fn.premiseDynamicColumns.defaults={grid:"row"}})(jQuery);(function(a){a.fn.premiseFieldDuplicate=function(b){var c=a.extend({},a.fn.premiseFieldDuplicate.defaults,b);if(this.length===0){return this}else if(this.length>1){this.each(function(){a(this).premiseFieldDuplicate(c)});return this}var d=a(this);var e=function(){if(!String.prototype.replaceLast){String.prototype.replaceLast=function(a,b){var c=a.toString(),d=b.toString(),e=this.lastIndexOf(c);if(e>=0){return this.substring(0,e)+d+this.substring(e+c.length)}return this.toString()}}if(!d.children(".premise-field-duplicate-add-button").length){d.prepend(c.addButton)}if(!d.children(".premise-field-duplicate-remove-button").length){d.prepend(c.removeButton)}h(d);if(!d.next(d.selector).length&&(d.find("input, textarea").val()||d.find("select option[selected=selected]").val()&&d.find('select option[value=""]').val())){f(d)}};var f=function(b){var d=b.clone();d.removeClass("clone");var e=b.find("select").val();d.find("select").val(e);h(d);b.find("input, textarea").val("");b.find("select").val(function(){return a(this).find("option").first().val()});b.find("input[type=checkbox]").prop("checked",false);b.before(d);c.onCopy.call(b,d)};var g=function(a){var b=a.prev(a.selector);a.remove();c.onRemove.call(a,b)};var h=function(a){a.on("click",".premise-field-duplicate-add-button",function(b){f(a);b.preventDefault()});a.on("click",".premise-field-duplicate-remove-button",function(b){g(a);b.preventDefault()})};e();return this};a.fn.premiseFieldDuplicate.getInputNameArrayId=function(a){if(a.substr(-2)==="[]"){return""}if(a.substr(-1)==="]"){a=a.substr(0,a.length-1)}var b=parseInt(a.substr(-1,1),10);if(!b){return""}for(var c=-2;;c--){var d=parseInt(a.substr(c,1),10);if(d){b=d.toString()+b}else{break}}return b};a.fn.premiseFieldDuplicate.incrementInputNameAndId=function(b){console.log(b.name,b.id);var c=a.fn.premiseFieldDuplicate.getInputNameArrayId(b.name);if(!c){return}var d=parseInt(c,10)+1;b.name=b.name.replaceLast(c,d);b.id=b.id.replaceLast(c,d)};a.fn.premiseFieldDuplicate.incrementText=function(a){var b=parseInt(a,10);if(b.toString()!==a){return a}return b+1};a.fn.premiseFieldDuplicate.defaults={onCopy:function(b){this.find("input, select, textarea").each(function(){a.fn.premiseFieldDuplicate.incrementInputNameAndId(this)});this.find(".increment").text(function(b,c){return a.fn.premiseFieldDuplicate.incrementText(c)});b.find(".premise-field-duplicate-add-button").toggle()},onRemove:function(a){if(!a.length){return}var b="."+a.attr("class").split(" ").join(".");if(a.parent().find(b+" .premise-field-duplicate-add-button:visible").length){return}a.find(".premise-field-duplicate-add-button").toggle()},addButton:'<i class="premise-field-duplicate-add-button fa fa-plus"></i>',removeButton:'<i class="premise-field-duplicate-remove-button fa fa-remove"></i>'}})(jQuery);(function(a){a.fn.premiseFieldFaIcon=function(b){var c=a.extend({},a.fn.premiseFieldFaIcon.defaults,b);if(this.length===0){return this}if(this.length>1){this.each(function(){a(this).premiseFieldFaIcon(b)});return this}var d=this,e=a(d),f=e.parent(".premise-field-fa_icon"),g=f.length?f.find(".premise-choose-icon"):{},h=f.length?f.find(".premise-remove-icon"):{},i=f.length?f.find(".premise-field-fa-icons-container"):{},j=i.length?i.find(".premise-field-fa-icon-anchor"):{},k=a("body"),l=a(document),m=false;var n=function(){if(e.is(".premise-fa-icon-plugin-active"))return false;o();p()};var o=function(){if(!e.is(".premise-field-fa_icon-input"))e.addClass("premise-field-fa_icon-input");if(!f.length)q();if(!g.length)r();if(!h.length)s();if(!i.length)t()};var p=function(){g.click(u);h.click(x);e.keyup(z);e.addClass("premise-fa-icon-plugin-active")};var q=function(){e.wrap('<div class="premise-field-fa_icon"></div>');f=e.parent(".premise-field-fa_icon")};var r=function(){var b=a('<a href="javascript:void(0);" class="premise-choose-icon"><i class="fa fa-fw fa-th"></i></a>');f.append(b);g=f.find(".premise-choose-icon")};var s=function(){var b=a('<a href="javascript:void(0);" class="premise-remove-icon"><i class="fa fa-fw fa-times"></i></a>');f.append(b);h=f.find(".premise-remove-icon")};var t=function(){var b=false;if(!b){a.post("/wp-admin/admin-ajax.php",{action:"premise_field_load_fa_icons_ajax"},function(a){b=true;f.append(a);i=f.find(".premise-field-fa-icons-container");j=i.find(".premise-field-fa-icon-anchor")})}};var u=function(){i.slideToggle("fast",function(){!m&&i.is(":visible")?v():w()});return false};var v=function(){k.addClass("premise-field-fa-icon-container-visible");y();l.trigger("premiseFieldAfterFaIconsOpen",[i,a(d)]);m=true};var w=function(){k.removeClass("premise-field-fa-icon-container-visible");l.trigger("premiseFieldAfterFaIconsClose",[i,a(d)]);m=false};var x=function(){e.val("")};var y=function(){j.off().one().click(function(){var b=a(this).attr("data-icon");e.val(b);u();return false})};var z=function(){var b=e.val();if(!m&&1>=b.length){u()}j.each(function(c,d){var e=a(this),f=e.attr("data-icon"),g=e.parents(".premise-field-fa-icon-li");!f.match(b)?g.hide():g.show()})};n();return this};a.fn.premiseFieldFaIcon.defaults={}})(jQuery);(function(a){a.fn.premiseFieldWpMedia=function(b){if(this.length===0){return this}var c=a.extend({},a.fn.premiseFieldWpMedia.defaults,b);var d=this;var e=a(d),f=e.parent(),g=e.siblings(".premise-btn-upload"),h=e.siblings(".premise-btn-remove"),i,j=[];if(this.length>1){this.each(function(){a(this).premiseFieldWpMedia(b)});return this}var k=function(){if(!e.is('input[type="text"]')){console.error('premiseFieldWpMedia() must be called on an input element with type="text".');return false}if(c.wrap)e.wrap('<div class="premise-field-wp_media"></div>');if(c.preview&&""!==e.val()){var b=e.val().split(",");for(var d=b.length-1;d>=0;d--){if(b[d].match(/(jpg|png|gif|jpeg)/gi)){j.push(b[d])}}o()}var f=e.attr("data-options");if(""!==f){var g=a.parseJSON(f);c=a.extend({},c,g)}q()};var l=function(){if(!wp.media){console.error("wp.media object is undefined. Make sure Wordpress Media Uploader Scripts are enqueued.");return false}if(i){i.open();return}i=wp.media.frames.file_frame=wp.media({title:"Upload Media",button:{text:"Insert Media"},multiple:c.multiple});i.on("select",function(){var b=i.state().get("selection").toJSON();j=[];a(b).each(function(a,b){if("id"===c.return){j.push(b.id)}else if("url"===c.return){var d="image"==b.type&&b.subtype.match(/(jpg|png|gif|jpeg)/gi)?b.sizes[c.imageSize].url:b.url;j.push(d)}});m()});i.open()};var m=function(){e.val(j.join());if(c.preview&&"url"==c.return)o()};var n=function(){e.val("");return false};var o=function(){if(j.length>0){var b=f.find(".premise-wp_media-preview"),c=j.length;if(!b.length){f.append(a('<div class="premise-wp_media-preview"></div>'));b=f.find(".premise-wp_media-preview")}b.html(p())}};var p=function(){var a='<div class="premise-row premise-wp_media-preview-inner">';if(j.length>1){for(var b=0;b<j.length;b++){var c=6>j.length?j.length:6;a+='<span class="premise-preview-thumb col'+c+'" style="background-image: url('+j[b]+');"></span>'}}else{a+='<span class="premise-preview-thumb span12" style="background-image: url('+j[0]+');"></span>'}a+="</div>";console.log(a);return a};var q=function(){if(!h.length){f.append(a('<a class="premise-btn-remove" href="javascript:void(0);"><i class="fa fa-fw fa-times"></i></a>'));h=a(".premise-btn-remove")}if(!g.length){f.append(a('<a class="premise-btn-upload" href="javascript:void(0);"><i class="fa fa-fw fa-upload"></i></a>'));g=a(".premise-btn-upload")}g.click(function(){console.log("upload btn was clicked");l()});h.click(function(){console.log("delete btn clicked");n()})};k();return this};a.fn.premiseFieldWpMedia.defaults={multiple:false,imageSize:"full","return":"url",preview:false,wrap:true}})(jQuery);var PremiseField={init:function(){this.bindEvents();jQuery(document).trigger("premiseFieldAfterInit",this)},bindEvents:function(){jQuery(".premise-wp-media-field").premiseFieldWpMedia();jQuery(".premise-field-fa_icon-input").premiseFieldFaIcon();jQuery(".premise-youtube-video").premiseLoadYouTube();jQuery(document).on("premiseFieldAfterInit",function(){console.log("PremiseField Object Initited successfully.")})}};function premiseSameHeight(a){a=a||".premise-same-height";var b=0,c;var d=jQuery(a).each(function(){if(c){return false}c=jQuery(this).attr("data-height");if(c){b=c;return false}var a=jQuery(this).outerHeight();if(a>b){b=a}});var e=jQuery(a).css("min-height",b);jQuery.when(d).done(e);return false}function premiseCountVisibleElements(a){a=a||[];var b=0;a.each(function(a,c){if(jQuery(c).is(":visible")){b++}});return b}function premiseBrowserName(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("opera")!=-1)return"Opera";if(a.indexOf("staroffice")!=-1)return"Star Office";if(a.indexOf("webtv")!=-1)return"WebTV";if(a.indexOf("beonex")!=-1)return"Beonex";if(a.indexOf("chimera")!=-1)return"Chimera";if(a.indexOf("netpositive")!=-1)return"NetPositive";if(a.indexOf("phoenix")!=-1)return"Phoenix";if(a.indexOf("firefox")!=-1)return"Firefox";if(a.indexOf("chrome")!=-1)return"Chrome";if(a.indexOf("safari")!=-1)return"Safari";if(a.indexOf("skipstone")!=-1)return"SkipStone";if(a.indexOf("msie")!=-1)return"Internet Explorer";if(a.indexOf("netscape")!=-1)return"Netscape";if(a.indexOf("mozilla/5.0")!=-1)return"Mozilla";if(a.indexOf("/")!=-1){if(a.substr(0,a.indexOf("/"))!="mozilla"){return navigator.userAgent.substr(0,a.indexOf("/"))}else return"Netscape"}else if(a.indexOf(" ")!=-1)return navigator.userAgent.substr(0,a.indexOf(" "));else return navigator.userAgent}(function(a){a.fn.premiseLoadYouTube=function(b){if(this.length===0){return this}var c=a.extend({},a.fn.premiseLoadYouTube.defaults,b);var d=this,e;if(this.length>1){this.each(function(){a(this).premiseLoadYouTube(b)});return this}var f=function(){g();"undefined"===typeof YT?i():h()};var g=function(){if(0===c.videoId.length){if(""!==d.attr("data-video-id")){c.videoId=d.attr("data-video-id")}else{console.error("premiseLoadYouTube a valid videoID is required.");return false}}c.playerVars.autoplay=c.playerVars.autoplay||c.autoplay;c.playerVars.playlist=c.playerVars.playlist||c.playlist;c.playerVars.loop=c.playerVars.loop||c.loop;if(c.playerVars.loop&&0===c.playerVars.playlist.length){c.playerVars.playlist=[c.videoId]}c.events.onReady=c.events.onReady||j};var h=function(){e=new YT.Player(d[0],{height:c.height,width:c.width,videoId:c.videoId,playerVars:c.playerVars,events:c.events});d.player=e};var i=function(){window.onYouTubeIframeAPIReady=h;var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)};var j=function(){if(-1!==c.volume)e.setVolume(c.volume);if(c.mute)e.mute();console.log("premiseLoadYouTube Player Ready")};f();return this};a.fn.premiseLoadYouTube.defaults={videoId:[],height:"390",width:"640",playerVars:{},events:{},autoplay:0,loop:0,playlist:[],mute:false,volume:-1}})(jQuery);jQuery(function(a){a(document).ready(function(){Premise.init()})});var Premise={init:function(){jQuery(".premise-dynamic-row").premiseDynamicColumns();PremiseField.init()}};